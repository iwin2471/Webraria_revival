(()=>{var m=class{constructor(){}static getInstance(){return this.instance==null&&(this.instance=new m),this.instance}initElement(e){this.element=document.getElementById(e),this.context=this.element.getContext("2d"),this.element.height=this.element.clientHeight,this.element.width=this.element.clientWidth}getContext(){return this.context}getElement(){return this.element}},a=m;var f=class{constructor(e,i){this.x=e,this.y=i}setXY(e,i){this.x=e,this.y=i}toString(){return`${this.x} ${this.y}`}},R=f;var b=class{constructor(e,i){this.sprite=new Image;this.loaded=!1;this.movementSpeed=8;this.position=new R;this.width=8;this.height=16;this.name=e,this.sprite.src=i,this.sprite.onload=()=>{this.loaded=!0}}get speed(){return this.movementSpeed}setPosition(e,i){this.position.setXY(e,i)}get x(){return this.position.x}get y(){return this.position.y}clearRect(){a.getInstance().getContext().clearRect(this.x,this.y,this.width,this.height)}isMonster(){return!1}},C=b;var v=class extends C{constructor(e,i){super(e,i);this.sideMovementSpeed=8;this.jumpForce=16;this.canJump=!1}},S=v;var u=class{constructor(e,i,n){this.x=0;this.pos=[];for(this.amp=e,this.wl=i,this.fq=1/i,this.psng=new E,this.a=this.psng.next(),this.b=this.psng.next(),this.pos=[];this.x<n;)this.x%this.wl==0?(this.a=this.b,this.b=this.psng.next(),this.pos.push(this.a*this.amp)):this.pos.push(this.interpolate(this.a,this.b,this.x%this.wl/this.wl)*this.amp),this.x++}interpolate(e,i,n){let r=n*Math.PI,s=(1-Math.cos(r))*.5;return e*(1-s)+i*s}generateNoise(e,i,n,r,s){let h=[];for(let g=0;g<n;g++)h.push(new u(e,i,s)),e/=r,i/=r;return h}combineNoise(e){let i=[];for(let n=0,r=0,s=0;n<e[0].pos.length;n++){for(r=0,s=0;s<e.length;s++)r+=e[s].pos[n];i.push(r)}return i}},x=u,E=class{constructor(){this.Z=0;this.M=4294967296;this.A=1664525;this.C=1;this.Z=Math.floor(Math.random()*this.M)}next(){return this.Z=(this.A*this.Z+this.C)%this.M,this.Z/this.M-.5}};var y=class{constructor(){this.worldTerrainSave=new Array;this.tileMap={tile:{dirt:[new Image,new Image,new Image,new Image],water:[new Image,new Image,new Image,new Image]},ore:[new Image,new Image,new Image,new Image,new Image]};this.tileMap.tile.dirt[0].src="Resource/Tiles/dirt/floor_dirt01.png",this.tileMap.tile.dirt[1].src="Resource/Tiles/dirt/floor_dirt02.png",this.tileMap.tile.dirt[2].src="Resource/Tiles/dirt/floor_dirt03.png",this.tileMap.tile.dirt[3].src="Resource/Tiles/dirt/floor_dirt04.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_opacity_90.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_opacity_95.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_surface_opacity_90.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_surface_opacity_95.png",this.tileMap.ore[0].src="Resource/Tiles/Mineral/copperS.png",this.tileMap.ore[1].src="Resource/Tiles/Mineral/iro.png",this.tileMap.ore[2].src="Resource/Tiles/Mineral/dia2.png",this.tileMap.ore[3].src="Resource/Tiles/object/stone.png",this.tileMap.ore[4].src="Resource/Tiles/dirt/floor_dirt04.png";for(let e=0;e<a.getInstance().getElement().width;e++)this.worldTerrainSave[e]=new Array}static getInstance(){return this.instance==null&&(this.instance=new y),this.instance}},d=y;d.tileSize=8;var o=d;var M=class{constructor(){this.canvas=a.getInstance();this.cnt=0;this.lastLayer=[];this.layerCnt=0}makeSomeNoise(){let e=new x(128,128,a.getInstance().getElement().width);return e.combineNoise(e.generateNoise(128,128,8,2,this.canvas.getElement().width))}generateWorld(){this.terrain=o.getInstance();let e=this.makeSomeNoise(),i=this.canvas.getElement(),n=this.canvas.getContext(),r=o.getInstance(),s=i.height,h=i.width,g=s/2,w=!1;n.clearRect(0,0,h,s),setTimeout(()=>{for(let c=0;c<h;c++){let L=g+e[c];w=!1;for(let p=0;p<s;p++)if(r.worldTerrainSave[c][p]=!1,p>L&&(r.worldTerrainSave[c][p]=!0,c%o.tileSize==0&&p%o.tileSize==0))if(w)n.drawImage(this.terrain.tileMap.tile.dirt[3],c,p);else{let A=Math.floor(Math.random()*3);n.drawImage(this.terrain.tileMap.tile.dirt[A],c,p),w=!0}}},500)}},_=M;var T=class{constructor(){this.worldgen=new _}generateWorld(){this.worldgen.generateWorld()}},k=T;var t=new S("JohnSoo","Resource/Character/3.png");var I=class{constructor(){this.canvas=a.getInstance();this.element=this.canvas.getElement();this.context=this.canvas.getContext();this.world=new k;this.frame=0}startGame(){this.terrian=o.getInstance(),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.canvas=a.getInstance(),this.element=this.canvas.getElement(),this.context=this.canvas.getContext(),this.elemLeft=this.element.offsetLeft+this.element.clientLeft,this.elemTop=this.element.offsetTop+this.element.clientTop,this.element.onclick=({clientX:e,clientY:i})=>{let n=e-this.element.getBoundingClientRect().left,r=i-this.element.getBoundingClientRect().top;console.log(n,r),console.log(this.terrian.worldTerrainSave[n][r])},t.setPosition(0,0),this.world.generateWorld(),this.loop()}loop(){window.requestAnimationFrame(()=>this.loop()),this.frame++,t.clearRect(),this.terrian.worldTerrainSave[t.position.x][t.position.y+16]?t.canJump=!0:t.position.y+=2,this.context.rect(t.position.y,t.position.y,t.width,t.height),this.context.fillStyle="rgba(0,0,0,0)",this.context.fill(),this.context.drawImage(t.sprite,t.position.x,t.position.y,t.width,t.height)}onKeyDown({keyCode:e}){switch(e){case 37:o.getInstance().worldTerrainSave[t.position.x-t.speed][t.position.y]||(t.clearRect(),t.position.x-=t.speed);break;case 32:case 38:if(!t.canJump)break;t.clearRect(),t.position.y-=t.jumpForce,t.canJump=!1;break;case 39:o.getInstance().worldTerrainSave[t.position.x+t.speed][t.position.y]||(t.clearRect(),t.position.x+=t.speed);break;case 40:t.clearRect(),t.position.y+=t.jumpForce;break}}onKeyUp({keyCode:e,type:i}){}};function j(){let l=new I;a.getInstance().initElement("main_canvas"),l.startGame()}j();})();
//# sourceMappingURL=bundle.js.map
