(()=>{var u=class{constructor(){}static getInstance(){return this.instance==null&&(this.instance=new u),this.instance}initElement(t){this.element=document.getElementById(t),this.context=this.element.getContext("2d"),this.context.scale(2,2),this.context.translate(0,-2500)}getContext(){return this.context}getElement(){return this.element}},a=u;var f=class{constructor(t,i){this.x=t,this.y=i}setXY(t,i){this.x=t,this.y=i}},I=f;var w=class{constructor(t,i){this.sprite=new Image;this.loaded=!1;this.movementSpeed=8;this.position=new I;this.width=8;this.height=16;this.name=t,this.sprite.src=i,this.sprite.onload=()=>{this.loaded=!0}}get speed(){return this.movementSpeed}setPosition(t,i){this.position.setXY(t,i)}get x(){return this.position.x}get y(){return this.position.y}clearRect(){a.getInstance().getContext().clearRect(this.x,this.y,this.width,this.height)}isMonster(){return!1}},R=w;var b=class extends R{constructor(t,i){super(t,i);this.sideMovementSpeed=8;this.jumpForce=8;this.canJump=!1}},C=b;var l=new Array;for(let s=0;s<1920*5;s++)l[s]=new Array;var x=class{constructor(){this.tileMap={tile:{dirt:[new Image,new Image,new Image,new Image],water:[new Image,new Image,new Image,new Image]},ore:[new Image,new Image,new Image,new Image,new Image]};this.tileMap.tile.dirt[0].src="Resource/Tiles/dirt/floor_dirt01.png",this.tileMap.tile.dirt[1].src="Resource/Tiles/dirt/floor_dirt02.png",this.tileMap.tile.dirt[2].src="Resource/Tiles/dirt/floor_dirt03.png",this.tileMap.tile.dirt[3].src="Resource/Tiles/dirt/floor_dirt04.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_opacity_90.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_opacity_95.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_surface_opacity_90.png",this.tileMap.tile.water[0].src="Resource/Tiles/liquid/water_surface_opacity_95.png",this.tileMap.ore[0].src="Resource/Tiles/Mineral/copperS.png",this.tileMap.ore[1].src="Resource/Tiles/Mineral/iro.png",this.tileMap.ore[2].src="Resource/Tiles/Mineral/dia2.png",this.tileMap.ore[3].src="Resource/Tiles/object/stone.png",this.tileMap.ore[4].src="Resource/Tiles/dirt/floor_dirt04.png"}static getInstance(){return this.instance}},m=x;m.instance=new x,m.tileSize=8;var d=class{constructor(t,i,n){this.x=0;this.pos=[];for(this.amp=t,this.wl=i,this.fq=1/i,this.psng=new S,this.a=this.psng.next(),this.b=this.psng.next(),this.pos=[];this.x<n;)this.x%this.wl==0?(this.a=this.b,this.b=this.psng.next(),this.pos.push(this.a*this.amp)):this.pos.push(this.interpolate(this.a,this.b,this.x%this.wl/this.wl)*this.amp),this.x++}interpolate(t,i,n){let r=n*Math.PI,o=(1-Math.cos(r))*.5;return t*(1-o)+i*o}generateNoise(t,i,n,r,o){let g=[];for(let h=0;h<n;h++)g.push(new d(t,i,o)),t/=r,i/=r;return g}combineNoise(t){let i=[];for(let n=0,r=0,o=0;n<t[0].pos.length;n++){for(r=0,o=0;o<t.length;o++)r+=t[o].pos[n];i.push(r)}return i}},v=d,S=class{constructor(){this.Z=0;this.M=4294967296;this.A=1664525;this.C=1;this.Z=Math.floor(Math.random()*this.M)}next(){return this.Z=(this.A*this.Z+this.C)%this.M,this.Z/this.M-.5}};var y=class{constructor(){this.canvas=a.getInstance();this.cnt=0;this.lastLayer=[];this.layerCnt=0;this.terrain=m.getInstance()}makeSomeNoise(){let t=new v(128,128,a.getInstance().getElement().width*5);return t.combineNoise(t.generateNoise(128,128,8,2,this.canvas.getElement().width*5))}generateWorld(){let t=this.makeSomeNoise(),i=this.canvas.getElement(),n=this.canvas.getContext(),r=i.height*5,o=i.width*5,g=r/2,h=!1;n.clearRect(0,0,o,r),setTimeout(()=>{for(let p=0;p<o;p+=m.tileSize){let L=g+t[p];h=!1;for(let c=0;c<r;c++)if(l[p][c]=!1,!(c<=L)&&c%m.tileSize==0)if(h)l[p][c]=!0,n.drawImage(this.terrain.tileMap.tile.dirt[3],p,c);else{l[p][c]=!0;let k=Math.floor(Math.random()*3);n.drawImage(this.terrain.tileMap.tile.dirt[k],p,c),h=!0}}},500)}},E=y;var M=class{constructor(){this.worldgen=new E}generateWorld(){this.worldgen.generateWorld()}},_=M;var e=new C("JohnSoo","Resource/Character/3.png");var T=class{constructor(){this.canvas=a.getInstance();this.element=this.canvas.getElement();this.context=this.canvas.getContext();this.world=new _;this.frame=0;window.addEventListener("keydown",j),window.addEventListener("keyup",P)}startGame(){this.canvas=a.getInstance(),this.element=this.canvas.getElement(),this.context=this.canvas.getContext(),this.elemLeft=this.element.offsetLeft+this.element.clientLeft,this.elemTop=this.element.offsetTop+this.element.clientTop,this.element.onclick=({pageX:t,pageY:i})=>{let n=t-this.elemLeft,r=i-this.elemTop;console.log(n/8,r*8),console.log(l[t][i])},e.setPosition(0,2400),this.world.generateWorld(),this.loop()}loop(){window.requestAnimationFrame(()=>this.loop()),this.frame++,e.clearRect(),l[e.position.x][e.position.y+16]?e.canJump=!0:e.position.y+=2,this.context.rect(e.position.y,e.position.y,e.width,e.height),this.context.fillStyle="rgba(0,0,0,0)",this.context.fill(),this.context.drawImage(e.sprite,e.position.x,e.position.y,e.width,e.height)}};function j({keyCode:s}){switch(s){case 37:l[e.position.x-e.speed][e.position.y]||(e.clearRect(),e.position.x-=e.speed);break;case 32:case 38:if(!e.canJump)break;e.clearRect(),e.position.y-=e.jumpForce,e.canJump=!1;break;case 39:l[e.position.x+e.speed][e.position.y]||(console.log(`${e.position.x} ${e.position.y}`),e.clearRect(),e.position.x+=e.speed);break;case 40:e.clearRect(),e.position.y+=e.jumpForce;break}}function P({keyCode:s,type:t}){}function q(){let s=new T;a.getInstance().initElement("mainCanvas"),s.startGame()}q();})();
//# sourceMappingURL=bundle.js.map
